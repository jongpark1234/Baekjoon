for r, g, b, k in map(lambda x: map(int, x.split()), [*open(0)][1:]): print(((k + (1 - (pow(b, k, 1000000007) * pow(b + 1, 1000000007 - k - 1, 1000000007) % 1000000007) + 1000000007) % 1000000007 * r % 1000000007) % 1000000007 + (g * pow(b, 1000000007 - 2, 1000000007) % 1000000007 * k % 1000000007)) % 1000000007)
